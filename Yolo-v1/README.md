# Yolo v1

## 论文地址:https://arxiv.org/pdf/1506.02640.pdf

Abstract

就是快

1. Introduction
   跟CNN比起来YOLO的突破，将对象检测重新定义为一个单一的回归问题，直接从图像像素到边界框坐标和类概率。使用我们的系统，您只查看一次(YOLO)图像来预测哪些对象以及它们在哪里。

![img](https://user-images.githubusercontent.com/28073374/137624985-d45ef8e4-3004-49f9-8358-86cf1992d7c0.png)


YOLO十分之简单，如上图。一个单一的卷积神经网络月物体框以及框种类。有如下几个有点。

第一:快。。。第二:全局的视野。跟滑动窗口定位技术有所不同。第三:可推广表示，在艺术领域其性能远高于DPM R-CNN。

2. Unified Detection

该论文将物体检测变成了单一的神经网络，网络中使用整个照片的特征值预测所有的物体框还有种类，这个设计变成了端对端的流程。所以速度非常块。

图片分成SxS个单元网格，每个单元网格有B个预测框以及这些框的置信分数。置信分数反映了这个框包含物体的程度以及对物体预测正确度。置信分数定义:Pr(Object)*IOU。如果预测的框并没有在物体内，则置信度为0.

每个预测框又包含了五个参数x，y，w，h,置信度C。

每个网格又预测目标属于不同种类的概率。最终，每个单元网格只预测一个物体。

在测试阶段，将物体可能性跟预测框置信分数相乘。那么对于每个预测框，则会获得一个类分类分数。这些分数预测了这个预测框拟合目标的程度。

![img_1](https://user-images.githubusercontent.com/28073374/137624993-22e2b032-1bdf-4cb2-a6d0-2919f60bd4e7.png)


在YOLO网络中。S=7，B=2，C=20.最终的tensor是7*7*30

2.1. Network Design

网络实现如下图所示

![img_2](https://user-images.githubusercontent.com/28073374/137625001-bfdf4aac-ddb4-4a37-a76f-fd7c87747987.png)


2.2. Training

对于最后一层的预测。将预测框的宽高进行归一化，落在0-1之间。x，y坐标划为特定单元格位置的偏移量。

最后一层使用线性激活函数，其他层使用leaky rectified linear激活函数


![img_3](https://user-images.githubusercontent.com/28073374/137625006-4394007c-43db-4e01-a465-b85d6c3aaaf4.png)


在输出中优化了平方和误差，我们使用平方和误差是因为它很容易优化，但它并不完全符合我们的最大化平均精度的目标。

由于很多单元网格不包含任何对象，很容易单元的置信度推向0，通常会唱过包含物体的梯度，会导致模型不稳定。

为了解决这个问题，提高了预测框的置信度的损失函数，减少了不包含目标的预测框的损失函数。于是λcoord = 5 和 λnoobj = .5

由于每个单元有多个预测框，但是只预测一个对象。所以IOU最高的预测框负责这个对象的预测。

![img_5.png](./assets/img_5.png)

损失函数细节参考 https://blog.csdn.net/qq_38236744/article/details/106724596

**这里强调两点:**
1.每个图片的每个单元格不一定都包含object，如果没有object，那么confidence就会变成0，这样在优化模型的时候可能会让梯度跨越太大，模型不稳定跑飞了。为了平衡这一点，在损失函数中，设置两个参数λcorrd
和λnoobj，其中λcorrd控制bbox预测位置的损失，λnoobj控制单个格内没有目标的损失。

2.对于大的物体，小的偏差对于小的物体影响较大，为了减少这个影响，所以对bbox的宽高都开根号。

2.3. Inference

VOC数据集的预测框每张照片一共有98个。每个单元网格被一个预测框负责。但是一些大一点的目标或者是目标边的网格，也能够被多个单元网格所定位。
非最大抑制可以用来修复这些多重检测。虽然不像R-CNN或DPM那样对性能至关重要，但非最大抑制在mAP中增加了2-3%。

2.4. Limitations of YOLO

框预测有很强的空间约束，因为每个单元网格只预测两个框，这个限制了我们可以预测的附近物体的数量。

3. Comparison to Other Detection Systems

略
